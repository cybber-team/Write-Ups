# Properly Decorated (REV 200) #
–ó–∞—Ä–∞–Ω–µ–µ —Å–∫–∞–∂—É, —á—Ç–æ —è –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ—Å—Ç–∏ –º–æ–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è.
–ü–æ –∑–∞–¥–∞–Ω–∏—é –Ω–∞–º –¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –∫–æ–¥–∏—Ä—É–µ—Ç –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫—Ä–∏–ø—Ç–∞:
```
 "MeW_^sto?üëàüèº_v0r_qexq/ONEpto\MeW_^op\iiv_üéìüè¥üëâüèº@^_MeW_^qefkh"
 ```
–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≥–ª–∞–≤–Ω–æ–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –≤ –ø—Ä—è–º–æ–º –ø–æ—Ä—è–¥–∫–µ, —Ç.–µ. –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä @emojified.
–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç, –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä—É–µ–º –¥–µ–∫–æ—Ä—Ç–∞—Ä—ã. –ü–æ–ø—Ä–æ–±—É–µ–º FLAG –ø—Ä–∏—Å–≤–∞–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä SchoolCTF{english_or_1337}, –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å —ç—Ç–∏–º –±—É–¥–µ–º –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º –∏ –∞–Ω–∞–ª–∏–∑—É –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞, –º—ã —Å—É–º–µ–ª–∏ –≤—ã–≤–µ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–∞:

–ê–ª–≥–æ—Ä–∏—Ç–º –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–∞
1. –ó–∞–º–µ–Ω—è–µ–º —Å–ª–æ–≤–∞ School, CTF, { –∏ } –Ω–∞ —ç–º–æ–¥–∂–∏-—Å–∏–º–≤–æ–ª—ã
2. –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "_"
3. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å –ø–æ–º–æ—â—å—é random.shuffle()
4. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è "_"
5. –ó–∞–º–µ–Ω—è–µ–º —Ü–∏—Ñ—Ä—ã –Ω–∞ –∏—Ö –±—É–∫–≤–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
6. –®–∏—Ñ—Ä—É–µ–º —Ü–µ–∑–∞—Ä–µ–º –≤—Å–µ –±—É–∫–≤—ã –Ω–∏–∂–Ω–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
7. –†–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "THREE"
8. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å –ø–æ–º–æ—â—å—é random.shuffle()
9. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è "to"
10. –ó–∞–º–µ–Ω—è–µ–º "oto" –Ω–∞ "^_MeW_^"
11. –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "_^_"
12. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Å –ø–æ–º–æ—â—å—é random.shuffle()
13. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è ""\"

–ü—Ä–æ—Å—Ç–æ –≤–∑—è—Ç—å –∏ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑—å–º–µ—Ç –∏ –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω–µ—Ç –Ω–∞–º –∏–∑–Ω–∞—á–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥, –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –∏–∑-–∑–∞ —Ñ—É–Ω–∫—Ü–∏–π random.shuffle(), –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—é—Ç —Å–ø–∏—Å–æ–∫. –û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏–∫—É –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞.

–ö–ª—é—á –¥–ª—è —Ü–µ–∑–∞—Ä—è —É–∑–Ω–∞–µ–º –ø—É—Ç–µ–º —Å–∫–∞—Ä–º–ª–∏–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ decaesared(text, key) –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–ª–∞–≥–∞ –∏ –∫–ª—é—á–∞ –æ—Ç 10 –¥–æ 100:


–í—ã–≤–µ–ª–æ 91 –≤–∞—Ä–∏–∞–Ω—Ç, –Ω–æ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ —Å —Ä–∞–∑–ª–∏—á–∏–º—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:
MhW_^vwr?????_y0u_that/ONEswr\MhW_^rs\lly_????????@^_MhW_^think [23]

–¢–µ–ø–µ—Ä—å –≤–æ–∑—å–º–µ–º—Å—è –ø–∏—Å–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –ø–æ –ø–æ–ª—É—á–µ–Ω–∏—é —Ñ–ª–∞–≥–∞. –ù–∞–ø–∏—à–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è:
1. –ü—Ä–µ–≤—Ä–∞—â–∞–µ–º —ç–º–æ–¥–∂–∏ –≤ —Å–ª–æ–≤–∞
2. –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "\"
3. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
4. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è "_^_"
5. –ó–∞–º–µ–Ω—è–µ–º "^_MeW_^" –Ω–∞ "oto"
6. –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "to"
7. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
8. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è "THREE"
9. –î–µ—à–∏—Ñ—Ä—É–µ–º —Ü–µ–∑–∞—Ä–µ–º
10. –ó–∞–º–µ–Ω—è–µ–º –±—É–∫–≤–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–∞–º–∏ —Ü–∏—Ñ—Ä—ã
11. –†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –ø–æ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é "_"
12. –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
13. –û–±—Ä–∞—Ç–Ω–æ —Å—Ü–µ–ø–ª—è–µ–º, —Ä–∞–∑–¥–µ–ª—è—è "_"

–ù–∞—á–Ω–µ–º —Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–ø. 1-4:
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-

from functools import wraps
import string
from itertools import permutations


FLAG = "MeW_^sto?üëàüèº_v0r_qexq/ONEpto\MeW_^op\iiv_üéìüè¥üëâüèº@^_MeW_^qefkh"

def demojified(text):
    text = text.replace('üëâüèº', '{')
    text = text.replace('üëàüèº', '}')
    text = text.replace('üéì', 'SCHOOL')
    text = text.replace('üè¥', 'CTF')
    return text

def decaesared(ct, key=23):
    pt = ''.join(
                chr((ord(c) - 0x61 - key) % len(string.ascii_lowercase) + 0x61)
                if c in string.ascii_lowercase else c for c in ct
            )
    return pt

def deverbosed(text):
    num2words = {1: 'One', 2: 'Two', 3: 'Three', 4: 'Four', 5: 'Five',
                 6: 'Six', 7: 'Seven', 8: 'Eight', 9: 'Nine', 10: 'Ten'}
    for k, v in num2words.items():
        text = text.replace(v.upper(), str(k))
    return text


def main():
    first_split = demojified(FLAG).split('\\')
    first_set = ['_^_'.join(x) for x in permutations(first_split, len(first_split))]
    first_set = [x.replace('^_MeW_^', 'oto') for x in first_set]

    for i in first_set:
        print(i)

if __name__ == '__main__':
    main()
```
–í—ã–≤–æ–¥:
```
MeW_^sto?}_v0r_qexq/ONEpto_otoop_^_iiv_SCHOOLCTF{@otoqefkh
MeW_^sto?}_v0r_qexq/ONEpto_^_iiv_SCHOOLCTF{@otoqefkh_otoop
MeW_^op_otosto?}_v0r_qexq/ONEpto_^_iiv_SCHOOLCTF{@otoqefkh
MeW_^op_^_iiv_SCHOOLCTF{@otoqefkh_otosto?}_v0r_qexq/ONEpto
iiv_SCHOOLCTF{@otoqefkh_otosto?}_v0r_qexq/ONEpto_otoop
iiv_SCHOOLCTF{@otoqefkh_otoop_otosto?}_v0r_qexq/ONEpto
```
–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å—Ç—Ä–æ–∫–∏ 1-4 –Ω–∞–º –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –Ω–∞–º –Ω–µ—É–¥–∞—Å—Ç—Å—è –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç "MeW_^" –≤ –Ω–∞—á–∞–ª–µ —ç—Ç–∏—Ö —Å—Ç—Ä–æ–∫, —Ç–∞–∫ –∫–∞–∫ –≤—Ä—è–¥ –ª–∏ —Ñ–ª–∞–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ç–∏ —Å–∏–º–≤–æ–ª—ã. –¢–µ–º —Å–∞–º—ã–º –º—ã —Å–æ–∫—Ä–∞—Ç–∏–º –≤—Ä–µ–º—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞. –í —Å–ª–µ–¥—É—é—â–µ–º –ª–∏—Å—Ç–∏–Ω–≥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Ç—Å–µ–≤ —ç—Ç–∏—Ö —á–µ—Ç—ã—Ä–µ—Ö —Å—Ç—Ä–æ–∫ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–ø. 5-9. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –¥–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –¶–µ–∑–∞—Ä—è –Ω–µ —Ç—Ä–æ–Ω—É–ª–∞ —Å–ª–æ–≤–æ School, –∏–∑–º–µ–Ω–∏–º —Ñ—É–Ω–∫—Ü–∏—é demojified: —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –±—ã–ª–∞ –∑–∞–º–µ–Ω–∞ –Ω–µ –Ω–∞ School, –∞ –Ω–∞ SCHOOL.


```python
def main():
    first_split = demojified(FLAG).split('\\')
    first_set = ['_^_'.join(x) for x in permutations(first_split, len(first_split))]
    first_set = [x.replace('^_MeW_^', 'oto') for x in first_set]
    first_set = first_set[-2:]  # –±–µ–∑ ^_MeW_^' —Ç–æ–ª—å–∫–æ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞

    second_split = [x.split('to') for x in first_set]
    second_set = []
    for second_spl_i in second_split:
        second_set += ['THREE'.join(x) for x in permutations(second_spl_i, len(second_spl_i))]

    second_set = [deverbosed(decaesared(x)) for x in second_set]

    for i in second_set:
        print(i)
```        

–í—ã–≤–æ–¥:
```
lly_SCHOOLCTF{@r3think_r3v3?}_y0u_that/1s3_r3rs
lly_SCHOOLCTF{@r3think_r3v3?}_y0u_that/1s3rs3_r
lly_SCHOOLCTF{@r3think_r3v3_r3?}_y0u_that/1s3rs
.............
```

–ù–∞–∫–æ–Ω–µ—Ü, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ –ø—É—Ç–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞-–∫–æ–¥–µ—Ä–∞ –∏ –∏–º–ø–æ—Ä—Ç–∞ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–∏

```python
from reverseme import get_flag

# .........

def main():
    first_split = demojified(FLAG).split('\\')
    first_set = ['_^_'.join(x) for x in permutations(first_split, len(first_split))]
    first_set = [x.replace('^_MeW_^', 'oto') for x in first_set]
    first_set = first_set[-2:]  # –±–µ–∑ ^_MeW_^' —Ç–æ–ª—å–∫–æ 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞

    second_split = [x.split('to') for x in first_set]
    second_set = []
    for second_spl_i in second_split:
        second_set += ['THREE'.join(x) for x in permutations(second_spl_i, len(second_spl_i))]

    second_set = [deverbosed(decaesared(x)) for x in second_set]

    for i in second_set:
        print(i)

    third_split = [x.split('_') for x in second_set]
    third_set = []
    for third_spl_i in third_split:
        third_set += ['_'.join(x).replace('SCHOOL', 'School') for x in permutations(third_spl_i, len(third_spl_i)) if x[0].startswith('SCHOOL') and x[-1].endswith('}')]

    for i in third_set:
        if get_flag(i) == FLAG:
            print("FLAG: " + i)
            return
```

–í –∏—Å–∫–æ–¥–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å
```python
def print_flag(flag):
    print(flag)
```
–Ω–∞
```python
def get_flag(flag):
    return flag
```
–ò –≤—É–∞-–ª—è:
```
FLAG: SchoolCTF{@r3_y0u_r3lly_think_that/1s_r3v3rs3?}
```
